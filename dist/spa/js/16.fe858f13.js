(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[16],{"30f8":function(e,t,s){},"9b36":function(e,t,s){"use strict";s("cfc2")},ab2b:function(e,t,s){"use strict";s("30f8")},cfc2:function(e,t,s){},f23a:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("AccountHeader",{attrs:{prevRoute:e.prevRoute,dialogName:e.$t("تسجيل الدخول")}},[a("div",{staticClass:"login"},[a("div",{staticClass:"row q-ma-md justify-center"},[a("GoogleAuthentication",{staticClass:"col-11 q-ma-sm",attrs:{label:e.googleLabel,prevRoute:e.prevRoute}}),a("FacebookAuthentication",{staticClass:"col-11 q-ma-sm",attrs:{label:e.facebookLabel,prevRoute:e.prevRoute}})],1),a("div",{staticClass:"text-center textStyle text-h4 q-mb-md"},[e._v("\n            OR\n        ")]),a("form",{attrs:{id:"loginForm"},on:{submit:function(t){return e.LoginUser(t)}}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-lg-12 col-xs-12"},[a("div",{staticClass:"inp"},[a("img",{attrs:{src:s("98c0"),alt:""}}),a("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"input",attrs:{id:"email",type:"email",placeholder:e.$t("الإيميل")},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}})]),a("div",{staticClass:"inp"},[a("img",{attrs:{src:s("c119"),alt:""}}),a("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"input",attrs:{id:"password",type:"password",placeholder:e.$t("كلمة المرور")},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]),a("div",{staticClass:"forget",staticStyle:{cursor:"pointer"}},[a("h3",[e._v("\n                            "+e._s(e.$t("هل نسيت كلمة"))+"\n                            "),a("a",{on:{click:e.goToPasswordResetPage}},[a("span",{staticClass:"hvr-float-shadow"},[e._v(e._s(e.$t("السر ؟")))])])])])])]),a("div",{staticClass:"next",staticStyle:{cursor:"pointer"}},[a("button",{staticClass:"action_btn",staticStyle:{outline:"none",border:"none",background:"transparent","box-shadow":"none"},attrs:{type:"submit",id:"loginBtn"}},[a("svg",{staticClass:"nexx",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"61.667",height:"54",viewBox:"0 0 61.667 54"}},[a("g",{attrs:{id:"Group_363","data-name":"Group 363",transform:"translate(0 54)"}},[a("path",{attrs:{id:"Path_55","data-name":"Path 595",d:"M61.667-27A23.678,23.678,0,0,0,38-50.667H28.333A23.678,23.678,0,0,0,4.667-27,23.678,23.678,0,0,0,28.333-3.333H38A23.678,23.678,0,0,0,61.667-27Z",fill:"#fbc74b","fill-rule":"evenodd"}}),a("path",{attrs:{id:"Path_56","data-name":"Path 596",d:"M28.333-1.333,27,0A27.013,27.013,0,0,1,0-27,27.013,27.013,0,0,1,27-54l1.333,1.333A25.679,25.679,0,0,0,2.667-27,25.679,25.679,0,0,0,28.333-1.333Z",fill:"#fbc74b","fill-rule":"evenodd"}})])]),a("img",{attrs:{src:s("1faf"),alt:""}})])])]),a("div",{staticClass:"creat"},[a("div",{staticClass:"orr"},[a("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"39.286",height:"56.942",viewBox:"0 0 39.286 56.942"}},[a("g",{attrs:{id:"Group_288","data-name":"Group 288",transform:"translate(-0.501 78.915)"}},[a("path",{attrs:{id:"Path_598","data-name":"Path 598",d:"M19.172-39.572a1.129,1.129,0,0,0-.069.6,1.467,1.467,0,0,0,.112.305,2.767,2.767,0,0,0,.866.96c1.369,1.009,2.539,1.832,2.838,3.106.226.961,0,2.231-1.159,4.084a12.806,12.806,0,0,0-1.549,3.77,15.694,15.694,0,0,0-.457,4.088.645.645,0,0,1-.6.685.645.645,0,0,1-.685-.6,16.916,16.916,0,0,1,.409-4.484,14.211,14.211,0,0,1,1.651-4.216c.827-1.37,1.1-2.267.923-2.967a2.22,2.22,0,0,0-.824-1.115c-.423-.357-.935-.692-1.47-1.073a3.623,3.623,0,0,1-1.7-2.615,2.2,2.2,0,0,1,.577-1.733,1.418,1.418,0,0,1,1.063-.435l2.777-.1A17.92,17.92,0,0,0,33.262-47.24,17.808,17.808,0,0,0,37.787-59.19,17.815,17.815,0,0,0,32.575-71.8,17.862,17.862,0,0,0,19.966-77.1,17.932,17.932,0,0,0,7.216-71.94,18.062,18.062,0,0,0,1.791-59.19a.645.645,0,0,1-.645.645A.645.645,0,0,1,.5-59.19a19.458,19.458,0,0,1,5.6-13.86,19.591,19.591,0,0,1,13.86-5.865,19.655,19.655,0,0,1,14,5.723,19.7,19.7,0,0,1,5.818,14A19.687,19.687,0,0,1,34.66-45.983a19.646,19.646,0,0,1-12.6,6.349Z",fill:"#e5e5e6","fill-rule":"evenodd"}})])]),a("span",[e._v(e._s(e.$t("أو")))])]),a("a",{staticStyle:{cursor:"pointer"},on:{click:e.goToSignUpPage}},[a("h3",{staticClass:"hvr-float-shadow"},[e._v(e._s(e.$t("إنشـاء حســاب")))])])]),a("q-inner-loading",{attrs:{showing:e.visible}},[a("q-spinner-hourglass",{attrs:{color:"primary",size:"70px"}})],1)],1)])},o=[],l=(s("ddb0"),s("9530")),i=s.n(l);let r,n=e=>e;const c=i()(r||(r=n`
mutation LoginUser($email:String!, $password: String!){
  tokenAuth(
    # username or email
    email: $email,
    password: $password,
  ) {
    success,
    errors,
    token,
    user {
      id,
      pk
      username,
      email,
      firstName,
      lastName,
      fullName,
      phoneNumber,
      phoneNumber2,
      phoneNumber3,
      verified,
      isAttachmentTransactionManager
      isPyramidAdmin
      isPyramidMarketer
      isInstructor
      userCurrency
    },
    refreshToken
  }
}
`));var u=s("2f62"),h=s("1da5"),p=s("be74"),m=s("ab5e"),d=s("26eb"),g=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"social"},[s("q-btn",{staticClass:"full-width",attrs:{label:e.label,icon:"la la-facebook",color:"primary"},on:{click:e.helloFacebookAuth}}),s("q-inner-loading",{attrs:{showing:e.visible}},[s("q-spinner-hourglass",{attrs:{color:"primary",size:"70px"}})],1)],1)},_=[],b=s("560c"),A={name:"FacebookAuthentication",data(){return{visible:!1}},props:["prevRoute","label"],methods:{...Object(u["b"])("authentication",["loginAction"]),...Object(u["b"])("settings",["setCurrencyAction"]),...Object(u["b"])("pyramidManagement",["GET_MY_MARKETING_CODE_ACCOUNT_ACTION"]),GoToHomePage(){this.$router.push({name:"Home"})},async IS_THE_USER_HAS_VALED_INROLLMENTS_IN_ANY_COURSE(){try{const e=await this.$apollo.query({query:p["a"]});return e.data.allEnrollmentsForCurrentUser.edges.length>0}catch(e){return!1}},async CHECK_IF_THE_USER_HASE_THE_REGISTERATION_CODE(){try{await this.$apollo.query({query:h["a"]});this.GET_MY_MARKETING_CODE_ACCOUNT_ACTION();const e=await this.IS_THE_USER_HAS_VALED_INROLLMENTS_IN_ANY_COURSE();e?this.$router.push({name:"my-courses"}):this.$router.push({name:"Home"})}catch(e){"GraphQL error: PyramidAffiliate matching query does not exist."==e.message&&(this.$q.notify({type:"positive",progress:!0,multiLine:!0,position:"top",message:"You must inter the registeration code"}),this.$router.push({name:"registeration-code"}))}},loginAuthMutation(e,t,s=""){console.log(" Triggering Apollo "),this.visible=!0,this.$apollo.mutate({mutation:b["a"],variables:{provider:t,accessToken:e,email:s}}).then((e=>{this.visible=!1;const t=e.data.socialAuth;t&&this.loginAction(t).then((()=>{try{const e=t.social.user.userCurrency;e&&("SDG"==e?this.setCurrencyAction("SDG"):this.setCurrencyAction("USD"));let s=t.social.user.email;OneSignal.push((function(){OneSignal.setExternalUserId(s)}))}catch(e){}t.token&&(this.$q.notify({type:"positive",progress:!0,multiLine:!0,position:"top",message:this.$t("تم تسجيل الدخول بنجاح")}),this.CHECK_IF_THE_USER_HASE_THE_REGISTERATION_CODE())}))})).catch((e=>{this.visible=!1}))},helloFacebookAuth(e="facebook"){const t=this.hello;t("facebook").login({scope:"public_profile,email",force:!0}).then((e=>{t("facebook").api(`/me?access_token=${e.authResponse.access_token}`).then((e=>{console.log("lllllllllllllllll"),console.log(e),console.log("lllllllllllllllll")}),(e=>{console.log("eeeeeeeeeeeeeeeeeeeee"),console.log(e),console.log("eeeeeeeeeeeeeeeeeeeee")}))}))}}},v=A,f=(s("ab2b"),s("2877")),E=s("9c40"),C=s("74f7"),y=s("9149"),S=s("0016"),w=s("eebe"),T=s.n(w),R=Object(f["a"])(v,g,_,!1,null,null,null),N=R.exports;T()(R,"components",{QBtn:E["a"],QInnerLoading:C["a"],QSpinnerHourglass:y["a"],QIcon:S["a"]});var O={data(){return{facebookLabel:"تسجيل الدخول عن طريق ال Facebook",googleLabel:"تسجيل الدخول عن طريق ال Google",email:"",password:"",prevRoute:null,visible:!1,errorMessages:[]}},components:{AccountHeader:m["a"],GoogleAuthentication:d["a"],FacebookAuthentication:N},beforeRouteEnter(e,t,s){s((e=>{e.prevRoute=t.fullPath}))},methods:{...Object(u["b"])("authentication",["loginAction"]),...Object(u["b"])("settings",["setCurrencyAction"]),...Object(u["b"])("pyramidManagement",["GET_MY_MARKETING_CODE_ACCOUNT_ACTION"]),goToPasswordResetPage(){this.$router.push({name:"password-reset"})},goToSignUpPage(){this.$router.push({name:"signUp"})},reset(){this.email="",this.password=""},errorHandler(e){for(const t in e)for(const s of e[t])this.$q.notify({type:"warning",position:"top",progress:!0,multiLine:!0,message:s.message})},LoginUser(e){e.preventDefault();try{this.visible=!0,this.errorMessages=[],this.$apollo.mutate({mutation:c,variables:{email:this.email,password:this.password}}).then((e=>{if(this.visible=!1,e.data.tokenAuth.success)if(e.data.tokenAuth.user.verified){try{const t=e.data.tokenAuth.user.userCurrency;t&&("SDG"==t?this.setCurrencyAction("SDG"):this.setCurrencyAction("USD"));let s=e.data.tokenAuth.user.email;OneSignal.push((function(){OneSignal.setExternalUserId(s)}))}catch(t){}this.loginAction(e.data.tokenAuth).then((()=>{this.$q.notify({type:"positive",progress:!0,multiLine:!0,position:"top",message:"logged in successfully"}),this.CHECK_IF_THE_USER_HASE_THE_REGISTERATION_CODE()}))}else this.$router.push({name:"password-confirm"});else e.data.tokenAuth.errors&&this.errorHandler(e.data.tokenAuth.errors)})).catch((e=>{console.log("lllllllllllllllll"),console.log(e),console.log("lllllllllllllllll"),this.visible=!1}))}catch(t){console.log("lllllllllllllllll"),console.log(t),console.log("lllllllllllllllll"),this.visible=!1}},async IS_THE_USER_HAS_VALED_INROLLMENTS_IN_ANY_COURSE(){try{const e=await this.$apollo.query({query:p["a"]});return e.data.allEnrollmentsForCurrentUser.edges.length>0}catch(e){return!1}},async CHECK_IF_THE_USER_HASE_THE_REGISTERATION_CODE(){try{await this.$apollo.query({query:h["a"]});this.GET_MY_MARKETING_CODE_ACCOUNT_ACTION();const e=await this.IS_THE_USER_HAS_VALED_INROLLMENTS_IN_ANY_COURSE();e?this.$router.push({name:"my-courses"}):this.$router.push({name:"Home"})}catch(e){"GraphQL error: PyramidAffiliate matching query does not exist."==e.message&&(this.$q.notify({type:"positive",progress:!0,multiLine:!0,position:"top",message:"You must inter the registeration code"}),this.$router.push({name:"registeration-code"}))}}}},I=O,H=(s("9b36"),Object(f["a"])(I,a,o,!1,null,null,null));t["default"]=H.exports;T()(H,"components",{QInnerLoading:C["a"],QSpinnerHourglass:y["a"]})}}]);